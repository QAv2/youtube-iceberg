<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Dynamics (9/14): Euler rates and quaternion rates â€” Iceberg Archive</title>
    <link rel="stylesheet" href="../style.css">
</head>
<body>
    <nav><a href="../index.html">&larr; Back to index</a></nav>

    <article>
        <h1>Flight Dynamics (9/14): Euler rates and quaternion rates</h1>
        <div class="meta">
            <span>Channel: DrEstes</span>
            <span>Published: 2020-09-14</span>
            <span>7,737 words</span>
            <span>Source: auto_caption</span>
        </div>
        <div class="tag-pills"><a href="../categories/advanced-mathematics-geometric-physics.html" class="tag-pill">Advanced Mathematics &amp; Geometric Physics</a></div>

        <div class="embed">
            <iframe width="560" height="315"
                src="https://www.youtube-nocookie.com/embed/7aBZt-t4wxc"
                frameborder="0" allowfullscreen></iframe>
        </div>

        <div class="transcript">
            <h2>Transcript</h2>
            <p>[Music] [Music] [Music] [Music] [Music] how&#x27;s it going you guys having a good monday [Music] [Music] just having a little apple cider it is fall after all as good as monday can be so no hey mondays are tough hey miracle i&#x27;m doing great how are you did you watch the f1 race yesterday i didn&#x27;t i didn&#x27;t shamiq who came out on top yesterday i was with my wife&#x27;s family we were watching the bills game hamilton no surprises there who does hamilton race for i should know zarin says hi dr i was unable to attend recitation on friday and saw it wasn&#x27;t recorded mercedes okay i&#x27;m still getting up to speed with f1 [Music] zeron says did i miss anything important on friday um so friday was covering some matlab basics so um that included some debugging [Music] some common errors that people encounter how to publish your matlab as a pdf so if you&#x27;re acquainted with those basics you didn&#x27;t really miss out oh miracle you watched that game but as a jets fan i&#x27;m sorry i&#x27;m sorry [Music] so sad about max who&#x27;s max what happened to max [Music] seren you&#x27;re welcome max verstappen an engine problem it&#x27;s kind of crazy to me how how that happens you know the stakes are so high i&#x27;m just surprised that they don&#x27;t identify those those problems i mean i know it&#x27;s like i obviously don&#x27;t know all that&#x27;s involved it&#x27;s very complex it&#x27;s just kind of crazy that he said on the formation lap his engine stalled [Music] gotta update the title okay [Music] out of 20 guys only 13 finished the race formula one really it&#x27;s something else that&#x27;s extremely high pressure all right everybody what do you say we get started today we&#x27;re talking about kinematic differential equations with euler rates as well as quaternions i&#x27;m going to start by motivating why this is important for aircraft dynamics all right so last time we showed that euler angles are a minimal parameterization of an attitude matrix in we introduced this mathematical space called so3 and so3 is the space of three by three matrices that are orthogonal and an orthogonal matrix all that means is that it preserves the length of the vector it operates on so a rotation matrix is orthogonal but additionally to be a rotation matrix you have to have a determinant of positive one an orthogonal matrix will have a determinant of plus one or minus one but minus one means that a reflection is happening um but no matter how you rotate an aircraft in the sky it can never become a reflection of itself so so3 is just a fancy mathematical word for all of the rotation matrices possible for an aircraft and a rotation matrix is just a way of describing its orientation in space so euler angles so there&#x27;s three of them there&#x27;s psi or maybe it&#x27;s c i&#x27;m not totally sure how you pronounce it theta and phi so this is a minimal parameterization of so3 because we showed last time that the constraints that a matrix needs to satisfy to be so3 that&#x27;s six different constraints um and if you have the most variables you could use for so3 is nine like if you make a direction cosine matrix using the cosines between basis vectors that uses nine parameters well if you you if you take away six or if you use six constraints that only leaves three variables so that&#x27;s where euler angles come from it&#x27;s a minimal set of variables to build an so3 matrix okay so given some euler angles and a position vector of the aircraft relative to a fixed frame so that would be the position vector of the cg of the aircraft which we call g relative to the origin of the fixed frame so given the euler angles and given this position vector you can define the pose of an aircraft oh my god are you going to make me do it uncle bill yeah whoa y&#x27;all okay so the pose of an aircraft is its position in space as well as its attitude or orientation so you need position vector you need the euler angles to define that so in real life how do i actually measure or estimate euler angles in order to determine the pose of an aircraft all right well this is where sensors come in all right so here we go i&#x27;m going to break this into i believe three steps so how do we measure or estimate euler angles so that we can get the pose perfectly said uncle bill okay great so we use body fixed sensors so these might be inertial measurement units fixed to the aircraft to measure among other things the angular velocity of the aircraft and because we&#x27;re measuring the angular velocity of the aircraft with body fixed sensors this angular velocity is going to be expressed in body frame coordinates okay so first step you&#x27;re going to get angular velocity readings from the aircraft it&#x27;s going to be in the body frame of the aircraft all right next step transform these body angular rates so that&#x27;s the angular velocity expressed in the body frame we call those the body angular rates into euler angle rates so we&#x27;ll define these a little bit later on but why don&#x27;t i just put these here these body angular rates we&#x27;re going to use the variables p q and r so these are the angular rates we measure with the sensors we&#x27;re going to transform them into euler angle rates so those are going to be the time derivatives of the euler angles okay so that&#x27;s step two you measure p q and r you transform them into the euler angle rates all right when you do this transformation and we&#x27;re going to get to this point today this we&#x27;ll call it a transformation results in a kinematic equation uvara g cena 26 says hi hello so this transformation between the euler angle rates and the body angle angular rates results in a kinematic differential equation what is the kinematic differential equation it&#x27;s a differential equation you integrate to recover the euler angles themselves or whatever attitude parameters you&#x27;re interested in so let me write that out in a kinematic differential equation so that just means we can integrate this equation to solve for the euler angles themselves so it&#x27;s like in dynamic systems when you solve a differential equation like x double dot plus blah blah blah x whatever when you solve that differential equation it&#x27;s then in terms of x there&#x27;s no derivatives left over all right so this is the procedure for getting oiler angles from sensors from an aircraft we&#x27;re gonna break it down so here&#x27;s another piece of information we can use the euler angles to get the pose but the euler angles in combination with the euler angle rates these are used for aircraft control so two types of control we&#x27;ll look at in this class are stabilization and we&#x27;ll do a little bit of flight path guidance as well so you can estimate the pose with these parameters you can also accomplish control which in my opinion control is the end purpose of studying dynamics right you understand how something moves so that you can manipulate it for your own purposes for evil or good that&#x27;s up to you i hope you choose for good okay so let&#x27;s get into it first we&#x27;re going to talk about aircraft angular velocity because this is where it all starts right you measure the angular velocity from sensors mounted to the aircraft so up above i mentioned p q and r so let&#x27;s break down what exactly they are all right so we have our fixed frame over here in blue it&#x27;s got its origin we have g the center of air center of gravity of the aircraft so the aircraft angular velocity so the angular velocity of the b frame relative to a fixed frame f expressed in body frame coordinates is let&#x27;s do this we know that to get the components of a vector relative to a frame we take the dot product of that vector with the basis vectors themselves oh before we get too much further just a notation thing when you look at this you should read it as angular velocity of b b relative to f all right so this angular velocity of b relative to f if we&#x27;re expressing it in the b frame we project that vector using the dot product onto each of the basis vectors so i&#x27;m going to recycle some of these so i&#x27;m dotting this with each of the basis vectors and that&#x27;ll give me my component along that basis vector direction okay so i&#x27;m dotting this one with b z and this is what i define p q and r to be so p is the projection of the angular velocity vector along the basis vector bx and then q and r and so physically this is what sensor gives us it&#x27;s in the body frame okay so writing out a vector this way with respect to its basis vectors what we call it basis vector representation or basis vector notation let&#x27;s write it in array form as well so this is how we like to notate it we put a subscript b to say it&#x27;s with respect to the body frame and so we can just put our components in that array and we call this array notation all right so it must be said p q and r are not the same as our euler rates or euler angle rates many of us make this mistake thinking they&#x27;re the same thing they&#x27;re not so let&#x27;s let&#x27;s break that down a little so let&#x27;s remember what the euler angles are and then um talk about the rates so the rates describe the angular velocity of the aircraft relative to the intermediate frames we used when defining the euler angles so i&#x27;m going to break this down with some pictures we&#x27;re going to go back memory lane to wednesday of last week where we define the euler angles and then it&#x27;ll make sense what these euler angle rates are and how it&#x27;s related to p q and r okay so remember the euler angles you use them to describe the orientation of an aircraft or spacecraft and you think of it as three successive rotations so the first rotate i start with the fixed frame which i have in this dark blue and i rotate it in angle c or psi however you prefer to say it and that brings me to my first intermediate frame and then i&#x27;m going to do another rotation but i&#x27;m going to do it about the intermediate frame so notice i&#x27;m starting with this teal and i rotate about that frame in angle theta and then finally i rotate about this dark green our our second intermediate frame and finally i arrive at the body frame which is expressed in b basis vectors so when you think about what c dot theta dot oh wait i said that wrong that&#x27;s v dot theta dot c dot when you think about what they are they&#x27;re angular velocities of these intermediate frames with respect to one another so the angular velocity of our first intermediate frame i1 with respect to the fixed frame that&#x27;s going to be psi dot and the way i drew these pictures we&#x27;re always rotating about the frame that&#x27;s i mean the the basis vector that&#x27;s pointing out of the page so like for this one i have f z which is equal to i three prime that&#x27;s coming out of the page and i&#x27;m rotating counter clockwise about that so this angular velocity of those two frames with respect to each other is this c dot about i3 prime now this second rotation it&#x27;s about the the two basis vector so that&#x27;s uh also known as i called it i2 double prime so theta dot this is describing the angular velocity of the second intermediate frame with respect to the first intermediate frame so i&#x27;m rotating with a rate theta dot about the axis i2 double prime and then we have one more rotation and finally this is going to be how the body frame rotates with respect to the second intermediate frame so let&#x27;s get right to it that&#x27;s going to be v dot about b x alright so these euler rates the main point they describe the rotation of intermediate frames with respect to each other now like i said at the beginning i want to relate these variables to p q and r which are the rates that i&#x27;m picking up from sensors and that&#x27;s what&#x27;s going to bring us to what we call the kinematic differential equation okay so to find the angular velocity with respect to the fixed frame we need to add those three angular velocities up above together so the angular velocity of b with respect to f it&#x27;s going to be chaining all of those intermediate angular velocities together so first the first rotation was i1 with respect to f my first intermediate frame with respect to the fixed frame and then the second rotation i did was um the second intermediate frame with respect to the first intermediate frame and then the last one was the angular velocity of the body frame with respect to the second intermediate frame so if you look at these additions you see these are kind of they&#x27;re tied together so if i want to go uh if i want to get the rate of b with respect to f i have to add all of these together at the same time so let&#x27;s substitute in the expressions from up above this first one was psi dot about i1 prime and then this one was theta dot about i to double prime i believe and then the last one v dot about bx our body frame vector and what we want to relate this to all right because we know we know that these two are equal in terms of so the same angular velocity but expressed purely in the body frame is going to be p q and r so is uh is i supposed to be i3 oh you&#x27;re talking about you&#x27;re absolutely right thank you crispy brownies thank you very much that&#x27;s definitely supposed to be i3 that&#x27;s what we did up above thank you okay so the way we&#x27;re going to relate these together we&#x27;re going to put this in array form and we&#x27;re going to use our trusty rotation matrices to help us relate these different basis vectors all right so we&#x27;re going to relate these two vectors using array notation and rotation matrices okay so with respect to the body frame we know the angular velocity is pqr now what i&#x27;m going to do i&#x27;m going to take our three components from up above in their different frames and convert them to the body frame so that we can add them together so we&#x27;re going to have the angular velocity with um with respect to the i1 frame so i&#x27;m going to take this first one right here so it&#x27;s c dot with respect to the third basis vector so in array form the first two basis vectors have a zero component and the third one is going to be side dot now if i want to express this component of the angular velocity with respect to the b frame well what i need to do is i need to multiply this vector by a rotation matrix well i&#x27;m going to break it into two but just so you know overall what we need we need the rotation matrix that goes from i one to b and last time we got rotation matrices that can give us this so we we have the rotation matrix from i1 to i2 and we also have the rotation matrix from i2 to b and this is how rotation matrices work you can just multiply them sequentially like this so if those superscripts are compatible and then um these outer numbers tell you you know that it&#x27;s from i 1 to b so i take this component of the angular velocity i multiply it by the rotation matrix from i 1 to b now this overall quantity will be with respect to the b frame now all right let&#x27;s keep going all right our second one theta dot with respect to i2 i mean yeah and and this is the second basis vector of that frame so just like before it&#x27;s theta dot with respect to the second basis vector of i2 and it wasn&#x27;t rotating at all about the other basis vectors in that coordinate system so those elements are zero of that vector okay just like before i gotta relate this to the b frame so we&#x27;ll take the rotation matrix from i to to b that&#x27;s a little bit easier this time we don&#x27;t have to multiply the matrices we just have that one ready to go all right the last component we have phi dot with respect to b x which is the first basis vector of the b frame so phi dot with respect to the first basis vector and there were no other components and this is already in the b frame so i don&#x27;t need to use any rotation matrices and below i for reference these are rotation matrices that we derived last time when we were looking at the euler angles so we can just multiply these together multiply it all out and i&#x27;m going to give you guys the end result here so if we multiply everything out as we wrote up above oops we&#x27;re going to see that pqr so the the components of the angular velocity in the b frame are related by this matrix to the euler angle rates and remember our goal is to so so this is a differential equation you can see that at this point i have this vector of derivatives of the euler angle rates and it&#x27;s some function of well the euler angles themselves and the sensor measurements that i&#x27;m getting but this differential equation is in a more convenient format if we invert this matrix so that we just have this vector standing by itself so if we multiply the left and right sides by the inverse that&#x27;s what we&#x27;re going to call the kinematic differential equation so let&#x27;s let me show you what this is going to be okay so if we invert that matrix let&#x27;s just write this out okay so this it&#x27;s going to be 3x3 the first column is one zero zero and the second column i&#x27;m going to use some abbreviated notation for sines and cosines and tangents so this is sine of phi times tangent theta and then the 2 2 element is cosine phi and then i have sine phi divided by cosine theta so this is the inverse of that matrix cosine phi tan theta how do you calculate the inverse of that three by three matrix i have done it by hand it&#x27;s good to do it maybe once in your life but after that i would use a symbolic toolbox in matlab not gonna lie nobody wants to invert a three by three matrix just telling the truth okay so this is a kinematic differential equation you can think of the inputs to this differential equation as the you know these sensor measurements p q and r that you&#x27;re getting from your from your aircraft and then if i solve this differential equation i get um or maybe i write this below well i&#x27;ll just write it here so we&#x27;re going to integrate this differential equation to get our euler rates or i mean not the rates just the euler angles themselves and that&#x27;ll give us the pose of the aircraft okay now this matrix we&#x27;re going to call it capital e and this is a function of this capital theta vector which it looks kind of like a little face doesn&#x27;t it i just had to point that out it kind of does let&#x27;s erase that though but now you can&#x27;t unsee it um so this capital theta vector is the vector of the euler angles so this matrix that relates p q and r to the euler angle rates is e and it&#x27;s a function of the euler angles themselves okay i don&#x27;t think i need to say anything more about that we can okay let&#x27;s just write this in a more compact notation i can say i take the e matrix it&#x27;s a function of this vector and i multiply it by the angular velocity vector expressed in the b frame because that&#x27;s what i get from my sensors from b to the fixed frame f so therefore when sampling that angular velocity vector from a sensor we can integrate this differential equation to update our estimate of the euler angles and this is in fact what you&#x27;re going to do not for your next homework but the homework after that we&#x27;re going to give you data from a quadcopter so you&#x27;re going to be getting all of these body angle rates from the gyroscope on there and we&#x27;re going to have you estimate the pose of the aircraft so that&#x27;s that&#x27;s what i really like about this that it&#x27;s a very practical skill when you develop this and when you make your own code to process this data you could do this for conceivably any aircraft that&#x27;s giving you this type of data okay however there&#x27;s a little caveat here there&#x27;s a problem with euler angles let&#x27;s let&#x27;s just get it out of the way when the pitch angle theta gets close to plus or minus 90 degrees this kinematic differential equation becomes unstable and uh well how does that happen we have some divide by zero singularities uh so how much of a problem is this uh i think for a commercial aircraft it&#x27;s probably not a big deal because i don&#x27;t think you&#x27;ll find very often the orientation of the aircraft having a a an angle theta of plus or minus 90 degrees but it could happen and and in that case your code that&#x27;s estimating the pose of the aircraft it&#x27;s going to go haywire um let&#x27;s show you from here how that happens so if we look at the matrix we&#x27;ll take take this for example if theta is 90 degrees cosine of theta is going to be zero right and then this numerator could be non-zero so you&#x27;re doing a divide by zero and the same thing&#x27;s happening at this element so you can have elements of this matrix that are undefined or or approaching infinity so that&#x27;s the problem this will work great until you get into a situation where theta approaches plus or minus 90 degrees and that&#x27;s what brings what about jets then do they use a different equation yes yes and that&#x27;s what we&#x27;re gonna do next i&#x27;m not just gonna leave you here hang in this is where quaternions come in so if you think of a fighter craft that&#x27;s going through all sorts of orientations it&#x27;s not going to be using euler angles or same thing with spacecraft and satellites because in space whatever i&#x27;m going to rotate into whatever orientation i need and the aerodynamics of that aren&#x27;t a problem okay so let&#x27;s break down exactly how this works what equation do the bills use i would say most of the time euler angles and then it gets them into trouble uh like four or five games in but most the time they&#x27;re okay you just have to cross your fingers okay so here we go the problem with the three two one euler angles is that when theta nears plus or minus 90 degrees we have i don&#x27;t know if you can read this but it says singularities so like a divide by zero singularity in the kinematic differential equation now by defining aircraft attitude in terms of quaternions which are also known as euler parameters we overcome the issue of singularities if you use quaternions you&#x27;ll have no singularities whatsoever well what is the price we pay it&#x27;s not a it&#x27;s not a terrible price actually it&#x27;s kind of it&#x27;s not too bad um this comes at the cost of parameterizing the attitude in terms of four parameters instead of three okay so so one more parameter that&#x27;s that&#x27;s not too bad actually so what are quaternions where do they come from the idea stems from euler&#x27;s principle rotation theorem let me tell you what that is and i&#x27;ll show you a figure too okay don&#x27;t get confused by this you have our fixed frame f that&#x27;s in blue and then superimposed on that i have the body frame in purple and the way that these two are related so this is what principle excuse me what principal rotation theorem says so wait let&#x27;s back it up what euler angles would do it would say that look this body frame is rotated to the i mean is is related to the fixed frame by three rotations about intermediate frames the principal rotation theorem says no no no no no no no this frame is related to the fixed frame by one rotation through an angle that we&#x27;re going to call gamma now the trick is that this angle of i mean that this rotation has to take place about a very specific axis uh which in this figure is in hat and this is the principal rotation wait did i get that name right look okay principal axis it&#x27;s easier than i thought so it&#x27;s a different way of looking at relating frames it&#x27;s saying okay we&#x27;re just going to do one rotation but because we&#x27;re just doing one it has to be about a very specific axis called the principal axis okay so let&#x27;s spell this out a rigid body or a coordinate reference frame can be brought from any initial orientation to any final orientation by a single rigid rotation of a principal angle gamma so this is how much you have to rotate about the principal axis in hat and this principle axis is fixed in the initial and final orientations it&#x27;s not going to change throughout the rotation now i have a bunch of very detailed notes about quaternions but we&#x27;re not going to get into them today i think i&#x27;ll post them as supplemental material if you really want to get into how this principle axis works and i know dr daryl covered this in a decent amount in intermediate dynamics as well but um it&#x27;s pretty interesting it&#x27;s a different way of thinking about rotations okay therefore to describe relative orientation with this principal rotation perspective you need to define the principal rotation vector so let&#x27;s define this vector um in the body frame so first i have to project that principle rotation vector onto each of the body frame axes so first i&#x27;m doing bx then i&#x27;m doing by we do projection using the dot product operation so let&#x27;s project onto b z oops so um because all of these are unit vectors the dot product also boils down to the cosine of the angle between the basis vectors so the angle between the principal axis and the basis vector bx is cosine of zeta one i know that squiggle is a little weird cosine of zeta two so zeta 2 is the angle between the principal axis and basis vector y and cosine zeta 3. so i&#x27;m just showing you some different representations here or we could just call the components n1 n2 and n3 the point i&#x27;m trying to make here to define that principal rotation vector you need three parameters so that&#x27;s already the same number of parameters we needed for the euler angles but now we need one additional parameter which you guessed it is how much we have to rotate about this vector so you need the components of the principal rotation vector or that principal axis and you also need the angle so this requires four parameters in one into n3 and gamma so if you&#x27;re going to think of rotations this way you have to define four parameters instead of three that&#x27;s where the four come from okay but i haven&#x27;t said quaternions yet so what are quaternions also known as euler parameters what are they quaternions are a set of variables defined in terms of n1 n2 n3 and gamma so it&#x27;s defined in front of the basis vectors for that axis and that angle and we define them in this way so there&#x27;s there&#x27;s four of them cosine of that angle divided by two and then the first basis vector sine gamma divided by two the second base vector also times sine gamma divided by two and the third sine gamma divided by two and you might be saying why the heck would you define them this way why didn&#x27;t we just pick n one in two and three and gamma that&#x27;s a lot easier to keep track of i&#x27;ll get to it okay so you can also collect these in a vector which we&#x27;ll call capital q so that&#x27;s q naught q one q two and q three and then even among these four quaternions we tend to break them down into this q naught and then little q vector where this little q is just the collection of q one q two and q three and this just turns out to be for some notation purposes later on it&#x27;s convenient to break them up in this way okay why are they defined this way they are defined in this way so that and you can prove this q naught squared plus q 1 squared plus q 2 squared plus q 3 squared equals one actually let&#x27;s let&#x27;s prove it because it&#x27;s really not hard to do so they specifically chose these definitions so that this holds true think about what the equation of this looks like so think about that as we prove this okay so cosine squared gamma over two so that&#x27;s q naught squared q one squared is n one squared sine squared gamma over two plus n two squared sine squared gamma over two plus n three squared sine squared gamma over two so does this equal one [Music] hmm we can factor out all these sine squareds right does that equal one okay here you have to remember in so that&#x27;s our [Music] principal axis it&#x27;s a unit vector so if you take the magnitude of that vector which would be that would equal one so this because n is a unit vector that&#x27;s one and then you&#x27;re just left with cosine squared plus sine squared which we know that is one okay so why what does it mean that this is equal to one well you can see this is the equation for a four-dimensional unit sphere can you visualize that i have no idea what that would look like in this way a given aircraft attitude described by this q vector so q not q one q two q three we know that all four of those parameters are going to add up to one so this means that any orientation of an aircraft with respect to quaternions we we represent that orientation as a point that lies on the surface of a 4d unit sphere that&#x27;s kind of trippy right all possible aircraft orientations can be represented as the surface of a four-dimensional unit sphere the main benefit once again is that there are no singularities whatsoever so it doesn&#x27;t matter how you flip around this aircraft in space however you orient that aircraft it&#x27;s just going to be represented by four quaternion parameters and they&#x27;re never going to become infinite at any point they just live on the surface of a four dimensional sphere okay now the rest of this stuff we&#x27;re not going to derive in lecture with a bunch of detail because that&#x27;s going to take a lot of time but i&#x27;m going to post some supplementary notes so if you&#x27;re really curious you can see where this comes from so we&#x27;re going to find the rotation matrix from the fixed frame to the b frame in terms of quaternions it turns out this equation although it may not look that way at face value this is the equation for a three by three rotation matrix so let&#x27;s break this down really quick so this this first term is an identity matrix three by three and we&#x27;re multiplying that by q naught squared q naught is a scalar and then we have this dot product of little q with little q remember the little q vector is q one q two q three so both of these numbers are scalars and we&#x27;re multiplying it by a three by three so this first term is a three by three matrix so moving on to the next term what the heck is this what is this x-men symbol that is called the outer product i think it&#x27;s a really cool symbol and so all that this means it&#x27;s equal to q multiplied with q transpose so if you haven&#x27;t done this before it can be a little weird but q little q is a three by one q transpose is a one by three and if you multiply these two together with the outer product this exists or it&#x27;s a three by three matrix that&#x27;s what i&#x27;m trying to say okay so the second term also three by three and then the last term it&#x27;s 2 times q 0 times this function s of the q vector so we define s in this way and it&#x27;s going to come up a couple times this s vector in essence it&#x27;s a way of expressing cross products as a matrix but it&#x27;s a three by three matrix minus q2 q1 zero okay so that&#x27;s a three by three matrix so what we have here we have an equation and it is a three by three actually this thing maybe we&#x27;ll take maybe take a second and so i want to show this to you q nut we&#x27;ll come back to that i&#x27;ll make a note to come back to this what is this sq matrix so okay let&#x27;s hold on i&#x27;m trying to remember exactly i think okay i think it&#x27;s equal to q whoops crossed no no hold on hold on hold on because this just gives this gives another vector let me bring this back it&#x27;s been a second since i used it and i&#x27;m like oh no this is what it is this is what it is it&#x27;s not even this it represents like this cross product operation okay with another vector so let&#x27;s let me show you let&#x27;s say i want to cross q with just like a generic vector v all right we&#x27;re gonna like bring this over here okay what i&#x27;m gonna do i&#x27;m gonna write this as q one and i&#x27;m just going to make up a basis because i think this is how it works q2 b2 so that&#x27;ll be q and then i&#x27;m going to cross it with um do i want to do that okay we&#x27;ll do this one v1 b1 v2 b2 okay so we got cross product of q with respect to v and then i&#x27;m just making up some basis vectors but it&#x27;s important that they&#x27;re with respect to the same basis so this would be q1 i&#x27;m going to copy this i&#x27;m going to distribute this so it&#x27;ll be like you take this vector you cross it with that and then you add this crossed with v2 b2 okay and then we add the last part v3 b3 okay so we&#x27;re expanding that out now i want to look at this line by line so i&#x27;m just going to keep spreading this way okay so this first line okay so you you gotta use like this rule for cross products by the way have you you&#x27;ve seen this probably right so like if i have b1 cross b2 that&#x27;s b3 but if i went the opposite direction if i want b1 b2 cross b1 that&#x27;d be minus b3 so like this is a what do you call it a mnemonic or something okay i forget what that thing&#x27;s called but we&#x27;re gonna we&#x27;re gonna break this down and b1 cross b1 if you cross the same vector with itself it&#x27;s just a zero vector so this is going to boil down to so these b1 b1 that&#x27;s going to cancel i&#x27;m going to have q2 v1 b2 cross b1 which is minus b3 and then i have b3 cross b1 which is b2 so that&#x27;s q3 v1 b2 so that&#x27;s what this first line&#x27;s going to be let&#x27;s just do each line because you&#x27;re going to add all these together um okay so i&#x27;m going to b1 because so i&#x27;m going to have q1 v2 cross with b2 that&#x27;s b3 b2b b2 goes to zero b3 b2 goes to minus b1 b1 okay so that&#x27;s the second line we&#x27;re gonna do the third line okay b1 cross b3 is going to be b2 q2 cross b3 is b1 okay wait wait i went in the opposite direction of the arrow this should be minus b2 minus all right all right all right all right doing really great b1 okay so we have to add all of these three lines together and i so when i add them together i&#x27;m going to gather terms and we&#x27;re just going to keep moving over to the right even further so let&#x27;s get all the b1 terms first [Music] okay so that&#x27;s going to be q2v3 minus q3v2 b1 those are all the b1s right and then okay b2 q3 v1 minus q1 v3 b2 and then b3 q1 v2 minus q2 v1 b3 okay so we got this by q crossed into v and then basically this s matrix is trying to turn this into some matrix operating on v so so basically it&#x27;s turning cross product into a matrix operation so i&#x27;m going to pull v off to the side so v what was v it was just v1 v2 v3 in some like b frame that i made up but it was whatever it was in the same frame as q and then i have to choose a matrix so that when i multiply this out i get the same thing that we got here which is going to be q 2 v 3 minus q 3 v 2. so that would be the first element q three v one minus q one v three and then q one v two minus q two v one and then we just have to solve this puzzle so the v2 element is multiplied by a minus q3 so i have to put like a minus q3 here and then v3 is multiplied by v2 so i have to put a q2 there and then there&#x27;s no v1 in that first you see what i&#x27;m doing here so if i multiply this row with v1 v2 v3 i&#x27;ll get back this q2 times v3 minus q3 times v2 okay then this is uh q3 times v1 minus q1 times v3 and then the last row i have to have minus q2 times v1 plus q1 times v2 and then plus zero times v3 and then we call this matrix s of q so so that means that so the whole point is if i take q cross into v that by definition is s q operating on v well thanks for asking about a potato i was going to skip over it because i was a little intimidated at first but once we got into it i was like dude this is it is a cool thing to show wait hopefully this thing matches let&#x27;s take this over here what if i copy this bring it over and it&#x27;s different than the s matrix that i defined oh bless the lord they&#x27;re the same so now you know but then you&#x27;ll ask yourself like what the heck though like this is a little weird because this isn&#x27;t operating on anything so it&#x27;s kind of just like a cross product matrix hanging in space it&#x27;s not it&#x27;s not operating on it it&#x27;s a little weird okay anyways if you guys uh multiply everything out in this equation and add it up you&#x27;re going to get this 3 by 3 matrix in terms of the quaternions so notice it&#x27;s just like any rotation matrix that goes from f to b but it&#x27;s parameterized in terms of four variables q naught q one q two q three all right now i wanna show you this is our last thing this is our last thing today deriving this one takes a little work as well like i said i have some notes on it so if you&#x27;re if you are interested i can hook you up but here we go this is our kinematic differential equation for quaternions so this is going to be a four by four matrix in here and then i&#x27;ll tell you how we use this matrix okay p zero r minus q q minus r zero zero p r q minus p zero okay so this matrix it&#x27;s it&#x27;s populated by p q and r well these p q and r&#x27;s are from um from our our friend the angular velocity vector so just to remind you that&#x27;s p q r okay so here&#x27;s the point of this kinematic differential equation um let&#x27;s say i have an aircraft that&#x27;s in the sky it&#x27;s giving me these sensor readings angular velocity with respect to the body frame okay so let&#x27;s say i get a set of p q and r once i get that i can build this matrix right i get those three readings and then i populate this four by four matrix with the readings i get from the sensor then assuming that i have some initial condition for my quaternions so you you do need some initial quaternions then i can integrate this and solve for q1q what you know what i&#x27;m saying i can solve this differential equation for the quaternions once you have the quaternions that set of four parameters corresponds to a unique attitude of an aircraft so it&#x27;s just like euler angles given euler angles three euler angles i can tell you this is where the aircraft is pointed in the sky well with quaternions if you give me all four of them that also corresponds to where an aircraft is positioned well how would you relate it to how it&#x27;s positioned it&#x27;ll go back to um this definition where this tells you the components of the principal axis with respect to the body frame and this tells you the angle it&#x27;s rotated about that axis so if you peel this back you can translate the quaternions into a unique orientation using a figure like this so it&#x27;s just a it&#x27;s a little less intuitive maybe but um but that&#x27;s the point in practice we&#x27;re getting sensor measurements we&#x27;re turning those into attitude parameters whether they&#x27;re euler angles or quaternions using integration and that tells us where the aircraft is you&#x27;re gonna get to practice this two homeworks from now i believe or one homework from now it&#x27;s like a little bit it&#x27;s very near in your future and with that that is our content for today i&#x27;ve shown you a kinematic differential equation for euler angles and one for quaternions as well don&#x27;t get lost in the math it&#x27;s very practical thanks for your attention today guys thanks for your questions thank you for potato for asking what that s matrix is i&#x27;m glad we went through that i&#x27;ll just hang out here for a little bit longer i gotta rewatch the video again it was pretty intense yeah it was pretty intense i agree pretty intense flight dynamics is pretty intense we&#x27;re taking it one step at a time hey see ya miracle thanks for thanks for being here [Music] i went to campus today briefly i&#x27;d uh do a little facilities meeting let&#x27;s get some dua lipa playing before next class but um yeah like nobody&#x27;s nobody&#x27;s on campus i thought it would be a little more populated than it is where&#x27;s this music from kind of slaps so i use a i&#x27;m using this it&#x27;s kind of cut off it&#x27;s the service called sound stripe this is called weeping tooth crust by isaac joel but anyways the special thing about this music provider is you you subscribe you have to pay but then i don&#x27;t know if you can see this on the right but they give you you can get the license for all of these songs so it&#x27;s perfect for something like twitch or youtube where you can get into copyright issues so i&#x27;m not going to have copyright issues for playing this music because i have access to the license it&#x27;s called sound stripe [Music] our groups have gotten random projects for 451 so do you think since we can we still can do your sponsor project if you&#x27;re ready to sponsor or is it too late unfortunately i think it&#x27;s too late because i have three groups and that&#x27;s already a lot [Music] yeah so i&#x27;m sorry i think three is the max i can take [Music] yeah sorry roo [Music] all right everybody thank you for your attention today i&#x27;m gonna peace out i&#x27;ll see you on wednesday looking forward to it [Music] do [Music] [Music] [Music] you</p>
        </div>
    </article>

    <footer>
        <p><a href="../index.html">&larr; Back to index</a></p>
    </footer>
</body>
</html>